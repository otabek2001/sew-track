{% extends 'base.html' %}
{% load static %}

{% block title %}Hisobotlar - {{ tenant.name }}{% endblock %}

{% block content %}
<!-- Admin Navigation -->
{% include 'admin_panel/components/_admin_nav.html' %}

<div class="min-h-screen bg-gray-50 pb-20 md:pb-8">
    <!-- Header -->
    <header class="bg-white border-b sticky top-0 z-40 shadow-sm">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-2xl font-bold text-gray-800">Hisobotlar va Export</h1>
                    <p class="text-sm text-gray-500">{{ tenant.name }}</p>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container mx-auto px-4 py-6">
        <!-- Quick Stats -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                <div class="flex items-center justify-between mb-3">
                    <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center">
                        <i data-lucide="file-text" class="w-6 h-6 text-blue-600"></i>
                    </div>
                </div>
                <p class="text-3xl font-bold text-gray-800">{{ stats.total_records }}</p>
                <p class="text-sm text-gray-600 mt-1">Jami yozuvlar</p>
            </div>

            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                <div class="flex items-center justify-between mb-3">
                    <div class="w-12 h-12 rounded-full bg-green-100 flex items-center justify-center">
                        <i data-lucide="users" class="w-6 h-6 text-green-600"></i>
                    </div>
                </div>
                <p class="text-3xl font-bold text-gray-800">{{ stats.total_employees }}</p>
                <p class="text-sm text-gray-600 mt-1">Xodimlar</p>
            </div>

            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                <div class="flex items-center justify-between mb-3">
                    <div class="w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center">
                        <i data-lucide="package" class="w-6 h-6 text-purple-600"></i>
                    </div>
                </div>
                <p class="text-3xl font-bold text-gray-800">{{ stats.total_products }}</p>
                <p class="text-sm text-gray-600 mt-1">Mahsulotlar</p>
            </div>

            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                <div class="flex items-center justify-between mb-3">
                    <div class="w-12 h-12 rounded-full bg-yellow-100 flex items-center justify-center">
                        <i data-lucide="calendar" class="w-6 h-6 text-yellow-600"></i>
                    </div>
                </div>
                <p class="text-3xl font-bold text-gray-800">{{ stats.today_records }}</p>
                <p class="text-sm text-gray-600 mt-1">Bugungi yozuvlar</p>
            </div>
        </div>

        <!-- Reports Grid -->
        <div class="grid md:grid-cols-2 gap-6">
            <!-- Daily Report -->
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6" x-data="{ showDatePicker: false, selectedDate: '' }">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center">
                        <i data-lucide="calendar-days" class="w-6 h-6 text-blue-600"></i>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-gray-800">Kunlik hisobot</h3>
                        <p class="text-sm text-gray-600">Bir kunlik barcha yozuvlar</p>
                    </div>
                </div>

                <div class="space-y-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Sana tanlang:</label>
                        <input 
                            type="date" 
                            x-model="selectedDate"
                            max="{{ today|date:'Y-m-d' }}"
                            class="w-full h-12 px-4 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-4 focus:ring-blue-100 focus:outline-none transition"
                        >
                    </div>

                    <a 
                        :href="`{% url 'admin_panel:export_daily' %}?date=${selectedDate || '{{ today|date:'Y-m-d' }}'}`"
                        class="w-full h-12 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition flex items-center justify-center gap-2"
                    >
                        <i data-lucide="download" class="w-5 h-5"></i>
                        <span>Excel yuklab olish</span>
                    </a>
                </div>
            </div>

            <!-- Monthly Report -->
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6" x-data="{ year: '{{ today.year }}', month: '{{ today.month }}' }">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-12 h-12 rounded-full bg-green-100 flex items-center justify-center">
                        <i data-lucide="bar-chart-3" class="w-6 h-6 text-green-600"></i>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-gray-800">Oylik hisobot</h3>
                        <p class="text-sm text-gray-600">Barcha xodimlar umumiy</p>
                    </div>
                </div>

                <div class="space-y-3">
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Oy:</label>
                            <select 
                                x-model="month"
                                class="w-full h-12 px-4 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-4 focus:ring-blue-100 focus:outline-none transition"
                            >
                                <option value="1" {% if today.month == 1 %}selected{% endif %}>Yanvar</option>
                                <option value="2" {% if today.month == 2 %}selected{% endif %}>Fevral</option>
                                <option value="3" {% if today.month == 3 %}selected{% endif %}>Mart</option>
                                <option value="4" {% if today.month == 4 %}selected{% endif %}>Aprel</option>
                                <option value="5" {% if today.month == 5 %}selected{% endif %}>May</option>
                                <option value="6" {% if today.month == 6 %}selected{% endif %}>Iyun</option>
                                <option value="7" {% if today.month == 7 %}selected{% endif %}>Iyul</option>
                                <option value="8" {% if today.month == 8 %}selected{% endif %}>Avgust</option>
                                <option value="9" {% if today.month == 9 %}selected{% endif %}>Sentabr</option>
                                <option value="10" {% if today.month == 10 %}selected{% endif %}>Oktabr</option>
                                <option value="11" {% if today.month == 11 %}selected{% endif %}>Noyabr</option>
                                <option value="12" {% if today.month == 12 %}selected{% endif %}>Dekabr</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Yil:</label>
                            <select 
                                x-model="year"
                                class="w-full h-12 px-4 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-4 focus:ring-blue-100 focus:outline-none transition"
                            >
                                <option value="2024" {% if today.year == 2024 %}selected{% endif %}>2024</option>
                                <option value="2025" {% if today.year == 2025 %}selected{% endif %}>2025</option>
                                <option value="2026" {% if today.year == 2026 %}selected{% endif %}>2026</option>
                            </select>
                        </div>
                    </div>

                    <a 
                        :href="`{% url 'admin_panel:export_monthly' %}?year=${year}&month=${month}`"
                        class="w-full h-12 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition flex items-center justify-center gap-2"
                    >
                        <i data-lucide="download" class="w-5 h-5"></i>
                        <span>Excel yuklab olish</span>
                    </a>
                </div>
            </div>

            <!-- Date Range Report -->
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6" x-data="{ startDate: '', endDate: '' }">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center">
                        <i data-lucide="calendar-range" class="w-6 h-6 text-purple-600"></i>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-gray-800">Davriy hisobot</h3>
                        <p class="text-sm text-gray-600">Barcha xodimlar (sana oralig'i)</p>
                    </div>
                </div>

                <div class="space-y-3">
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Boshlanish:</label>
                            <input 
                                type="date" 
                                x-model="startDate"
                                max="{{ today|date:'Y-m-d' }}"
                                class="w-full h-12 px-4 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-4 focus:ring-blue-100 focus:outline-none transition"
                            >
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tugash:</label>
                            <input 
                                type="date" 
                                x-model="endDate"
                                max="{{ today|date:'Y-m-d' }}"
                                class="w-full h-12 px-4 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-4 focus:ring-blue-100 focus:outline-none transition"
                            >
                        </div>
                    </div>

                    <a 
                        :href="`{% url 'admin_panel:export_date_range' %}?start_date=${startDate || '{{ today|date:'Y-m-01' }}'}&end_date=${endDate || '{{ today|date:'Y-m-d' }}'}`"
                        class="w-full h-12 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition flex items-center justify-center gap-2"
                    >
                        <i data-lucide="download" class="w-5 h-5"></i>
                        <span>Excel yuklab olish</span>
                    </a>
                </div>
            </div>

            <!-- Employee Report -->
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-12 h-12 rounded-full bg-orange-100 flex items-center justify-center">
                        <i data-lucide="user" class="w-6 h-6 text-orange-600"></i>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-gray-800">Xodim hisoboti</h3>
                        <p class="text-sm text-gray-600">Shaxsiy hisobot yuklab olish</p>
                    </div>
                </div>

                <div class="space-y-3">
                    <p class="text-sm text-gray-600">
                        Xodimlar ro'yxatidan tanlang va ularning shaxsiy hisobotini yuklab oling.
                    </p>

                    <a 
                        href="{% url 'admin_panel:employee_list' %}"
                        class="w-full h-12 bg-orange-600 hover:bg-orange-700 text-white font-medium rounded-lg transition flex items-center justify-center gap-2"
                    >
                        <i data-lucide="arrow-right" class="w-5 h-5"></i>
                        <span>Xodimlar ro'yxatiga</span>
                    </a>
                </div>
            </div>
        </div>

        <!-- Info Section -->
        <div class="mt-6 bg-blue-50 border border-blue-200 rounded-xl p-6">
            <div class="flex items-start gap-3">
                <i data-lucide="info" class="w-6 h-6 text-blue-600 mt-0.5"></i>
                <div>
                    <h4 class="font-bold text-blue-900 mb-2">Hisobotlar haqida</h4>
                    <ul class="space-y-1 text-sm text-blue-800">
                        <li>• <strong>Kunlik hisobot</strong> - Tanlangan sana uchun barcha ishlar</li>
                        <li>• <strong>Oylik hisobot</strong> - Barcha xodimlar bo'yicha umumiy natijalar (oy/yil)</li>
                        <li>• <strong>Davriy hisobot</strong> - Barcha xodimlar umumiy (custom sana oralig'i)</li>
                        <li>• <strong>Xodim hisoboti</strong> - Individual xodim statistikasi</li>
                        <li>• <strong>Format</strong> - Barcha hisobotlar Excel (xlsx) formatida</li>
                        <li>• <strong>Ma'lumotlar</strong> - Tasdiqlangan va tasdiqlash kutilayotgan ishlar</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    if (typeof lucide !== 'undefined') {
        lucide.createIcons();
    }
});
</script>
{% endblock %}

